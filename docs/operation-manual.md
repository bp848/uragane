# PDF管理システム 操作マニュアル

## 目次
1. [システム概要](#システム概要)
2. [アクセス方法](#アクセス方法)
3. [PDFアップロード](#pdfアップロード)
4. [文書管理](#文書管理)
5. [AI検索](#ai検索)
6. [トラブルシューティング](#トラブルシューティング)

## システム概要

政治資金収支報告書PDFファイルを管理し、AIを活用した検索・分析を行うシステムです。

### 主な機能
- **PDFアップロード**: 複数ファイルの一括アップロード
- **メタ情報管理**: 政党名・地域名の自動抽出と編集
- **インデックス化**: Groq AIによるテキスト抽出とベクトル化
- **AI検索**: 自然言語による文書検索と質問応答

## アクセス方法

1. ブラウザで管理画面にアクセス
2. 左サイドバーから「PDF文書管理」を選択
3. 3つのタブが利用可能：
   - **アップロード**: ファイルのアップロード
   - **文書管理**: アップロード済みファイルの管理
   - **AI検索**: インデックス済み文書への質問

## PDFアップロード

### 1. アップロード画面へのアクセス
「アップロード」タブを選択します。

### 2. ファイルの選択
以下の方法でファイルを選択できます：
- **ドラッグ&ドロップ**: ファイルを画面上の点線エリアにドラッグ
- **ファイル選択**: 点線エリアをクリックしてファイル選択ダイアログを開く

### 3. アップロード制限
- **ファイル形式**: PDFファイルのみ
- **ファイルサイズ**: 最大4.5MB/ファイル
- **同時アップロード**: 複数ファイル対応

### 4. アップロード進捗の確認
- リアルタイムで進捗バーが表示
- 成功・エラー状況を個別に確認可能
- エラー時は詳細メッセージを表示

### 5. メタ情報の自動抽出
アップロード時に以下の情報が自動抽出されます：
- **政党名**: ファイル名から政党名を検出
- **地域名**: ファイル名から都道府県・地域名を検出
- 抽出できない場合は「不明」として保存

## 文書管理

### 1. 文書一覧の表示
「文書管理」タブで全アップロード済みファイルを確認できます。

### 2. フィルタリング機能
以下の条件で文書を絞り込み可能：
- **ステータス**: 待機中/処理中/完了/エラー
- **政党名**: 抽出された政党名
- **地域名**: 抽出された地域名
- **検索**: ファイル名での部分一致検索

### 3. ステータスの種類
- **待機中**: アップロード完了、インデックス化待ち
- **処理中**: インデックス化実行中
- **完了**: インデックス化完了、検索対象
- **エラー**: インデックス化失敗

### 4. インデックス化の実行
1. インデックス化したい文書にチェックを入れる
2. 「インデックス化」ボタンをクリック
3. バックグラウンドで処理が開始される
4. ステータスがリアルタイムで更新される

### 5. 文書の操作
- **ダウンロード**: 元のPDFファイルをダウンロード
- **メタ情報編集**: 政党名・地域名の手動修正（将来実装）
- **削除**: 不要な文書の削除（将来実装）

## AI検索

### 1. 検索画面へのアクセス
「AI検索」タブを選択します。

### 2. 質問の入力
- テキストボックスに自然言語で質問を入力
- Enterキーまたは送信ボタンで質問を送信

### 3. 質問例
\`\`\`
○○党の収入源について教えて
広島県の政治資金の特徴は？
最も多額の寄付を受けた政治家は？
建設業界からの献金状況を分析して
過去1年間の資金の流れの傾向は？
\`\`\`

### 4. 回答の確認
- AIが生成した回答がチャット形式で表示
- 回答の根拠となった文書名も併せて表示
- 参照文書は最大3件まで表示

### 5. セッション管理
- 質問履歴は自動的にセッションとして保存
- 過去の質問・回答を参照可能
- 新しいセッションは自動的に作成

## トラブルシューティング

### アップロード関連

#### Q: ファイルがアップロードできない
**A: 以下を確認してください**
- ファイル形式がPDFか
- ファイルサイズが4.5MB以下か
- 同じファイルが既にアップロード済みでないか
- ネットワーク接続が安定しているか

#### Q: アップロードが途中で止まる
**A: 対処方法**
1. ページを更新して再試行
2. ファイルサイズを確認（4.5MB以下）
3. ブラウザのキャッシュをクリア
4. 別のブラウザで試行

### インデックス化関連

#### Q: インデックス化がエラーになる
**A: 考えられる原因**
- PDFファイルが破損している
- テキスト抽出ができないPDF（画像のみなど）
- Groq APIの一時的な障害
- ネットワーク接続の問題

**対処方法**
1. エラーメッセージを確認
2. 別のPDFファイルで試行
3. 時間をおいて再実行
4. 管理者に連絡

#### Q: インデックス化が「処理中」のまま進まない
**A: 対処方法**
1. ページを更新してステータス確認
2. 5分以上経過している場合は管理者に連絡
3. 他のファイルで試行

### AI検索関連

#### Q: 検索結果が表示されない
**A: 確認事項**
- インデックス化が完了した文書があるか
- 質問が明確で具体的か
- ネットワーク接続が安定しているか

#### Q: 回答が不正確
**A: 改善方法**
- より具体的な質問に変更
- 政党名や地域名を明記
- 期間を限定した質問にする

#### Q: 「通信エラーが発生しました」と表示される
**A: 対処方法**
1. ネットワーク接続を確認
2. ページを更新して再試行
3. ブラウザのキャッシュをクリア
4. 管理者に連絡

### 一般的な問題

#### Q: 画面が正しく表示されない
**A: 対処方法**
1. ブラウザを最新版に更新
2. キャッシュとCookieをクリア
3. 別のブラウザで試行
4. JavaScript が有効になっているか確認

#### Q: 動作が重い
**A: 改善方法**
1. 不要なブラウザタブを閉じる
2. ブラウザを再起動
3. PCの再起動
4. ネットワーク速度を確認

## サポート情報

### 推奨環境
- **ブラウザ**: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- **JavaScript**: 有効
- **ネットワーク**: 安定したインターネット接続

### 連絡先
技術的な問題や質問がある場合は、システム管理者にお問い合わせください。

### 更新履歴
- v1.0.0: 初回リリース（2024年12月）
  - PDFアップロード機能
  - インデックス化機能
  - AI検索機能
